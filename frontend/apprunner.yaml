version: 1.0
runtime: nodejs

build:
  commands:
    pre-build:
      - apt-get update
      - apt-get install -y curl git unzip xz-utils python3
      - git clone https://github.com/flutter/flutter.git
      - export PATH="$PATH:`pwd`/flutter/bin"
      - flutter precache
      - flutter config --enable-web
      - flutter doctor
    build:
      - cd frontend
      - flutter pub get
      - flutter build web

run:
  command: cd frontend/build/web && python3 -m http.server 8080
  network:
    port: 8080
  env:
    - name: NODE_VERSION
      value: "18"
      
run:
  command: cd frontend/build/web && python3 -m http.server 8080
  network:
    port: 8080
  env:
    - name: PORT
      value: "8080"
    env: PORT